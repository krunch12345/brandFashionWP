Vue.component('header-comp',{
    props:['cartitems','addproduct'],
    template: `
            <div class="page-header-btn">
                <button onclick="myFunction()" class="menu-btn">
                    <svg width="32" height="23" viewBox="0 0 32 23" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0 23V20.31H32V23H0ZM0 12.76V10.07H32V12.76H0ZM0 2.69V0H32V2.69H0Z"/>
                    </svg>
                </button>
                <a href="registration.html" class="account-btn">
                    <svg width="29" height="29" viewBox="0 0 29 29" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M14.5 19.937C19 19.937 22.656 15.464 22.656 9.968C22.656 4.472 19 0 14.5 0C13.3631 0.0217413 12.2463 0.303398 11.2351 0.823397C10.2239 1.34339 9.34507 2.08794 8.66602 3C7.12663 4.99573 6.30819 7.45381 6.34399 9.974C6.34399 15.465 10 19.937 14.5 19.937ZM14.5 1.813C18 1.813 20.844 5.472 20.844 9.969C20.844 14.466 17.998 18.125 14.5 18.125C11.002 18.125 8.15603 14.465 8.15503 9.969C8.15403 5.473 11 1.813 14.5 1.813ZM20.844 18.125C20.6036 18.125 20.373 18.2205 20.203 18.3905C20.033 18.5605 19.9375 18.7911 19.9375 19.0315C19.9375 19.2719 20.033 19.5025 20.203 19.6725C20.373 19.8425 20.6036 19.938 20.844 19.938C22.526 19.9399 24.1386 20.6088 25.3279 21.7982C26.5172 22.9875 27.1861 24.6 27.188 26.282C27.1875 26.5221 27.0918 26.7523 26.922 26.9221C26.7522 27.0918 26.5221 27.1875 26.282 27.188H2.71997C2.47985 27.1875 2.24975 27.0918 2.07996 26.9221C1.91016 26.7523 1.81449 26.5221 1.81396 26.282C1.81608 24.6001 2.48517 22.9877 3.67444 21.7985C4.86371 20.6092 6.47608 19.9401 8.15796 19.938C8.39824 19.938 8.62868 19.8425 8.79858 19.6726C8.96849 19.5027 9.06396 19.2723 9.06396 19.032C9.06396 18.7917 8.96849 18.5613 8.79858 18.3914C8.62868 18.2215 8.39824 18.126 8.15796 18.126C5.99541 18.1279 3.92201 18.9875 2.39258 20.5164C0.863144 22.0453 0.00264777 24.1185 0 26.281C0.000794067 27.0019 0.287502 27.693 0.797241 28.2027C1.30698 28.7125 1.99811 28.9992 2.71899 29H26.282C27.0027 28.9989 27.6936 28.7121 28.2031 28.2024C28.7126 27.6927 28.9992 27.0017 29 26.281C28.9974 24.1187 28.1372 22.0457 26.6083 20.5168C25.0793 18.9878 23.0063 18.1276 20.844 18.125Z"/>
                    </svg>
                </a>
    
                <cart
                    :cartitems = 'cartitems'
                    :addproduct='addproduct'
                >
                </cart>
    
            </div>
    `
})

Vue.component('cart',{
    props:['cartitems','addproduct'],
    data(){
        return {
            isVisibleCart: false,
        }
    },
    methods: {
        calculateCart() {
            let cartPrice = 0;
            let cart = this.$parent.$parent.cartGoods[1];
            cart.forEach(el => cartPrice += el.quantity * el.price)
            return cartPrice;
        },
        deleteItem(id) {
            let remove = this.$parent.$parent.remove;
            let cart = this.$parent.$parent.cartGoods[1];
            let find = cart.find(el => el.id_product === id);

            remove(`/api/cart/${id}`,find);
            //    const curElement = this.cartitems.find(el => el.id_product == id);
            //    if (curElement.count == 1) {
            //        this.cartitems.splice(this.cartitems.indexOf(curElement), 1);
            //    } else {
            //         --curElement.count;
            //    }
        }
    },
    template: `
        <div class="cart">
            <button
                class="cart-btn"
                type="button"
                @click="isVisibleCart = !isVisibleCart"
            >
                <svg width="46" height="45" viewBox="0 0 46 45" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M30.2009 37C29.5532 36.9738 28.9415 36.6948 28.4972 36.2227C28.0529 35.7506 27.8114 35.1232 27.8245 34.475C27.8376 33.8269 28.1043 33.2097 28.5673 32.7559C29.0303 32.3022 29.6527 32.048 30.301 32.048C30.9493 32.048 31.5717 32.3022 32.0347 32.7559C32.4977 33.2097 32.7644 33.8269 32.7775 34.475C32.7906 35.1232 32.549 35.7506 32.1047 36.2227C31.6604 36.6948 31.0488 36.9738 30.401 37H30.2009ZM10.7529 34.32C10.7529 33.79 10.9101 33.2718 11.2046 32.8311C11.4991 32.3904 11.9176 32.0469 12.4073 31.844C12.8971 31.6412 13.4359 31.5881 13.9558 31.6915C14.4757 31.7949 14.9532 32.0502 15.328 32.425C15.7028 32.7998 15.9581 33.2773 16.0615 33.7972C16.1649 34.317 16.1118 34.8559 15.9089 35.3456C15.7061 35.8353 15.3626 36.2539 14.9219 36.5483C14.4812 36.8428 13.963 37 13.433 37C13.0809 37.0003 12.7321 36.9311 12.4067 36.7966C12.0814 36.662 11.7857 36.4646 11.5366 36.2158C11.2875 35.9669 11.09 35.6713 10.9552 35.3461C10.8204 35.0208 10.751 34.6721 10.751 34.32H10.7529ZM14.553 28.686C14.2935 28.6868 14.0409 28.6024 13.8341 28.4457C13.6273 28.2891 13.4776 28.0689 13.408 27.819L8.57495 10.364H5.18201C4.86852 10.364 4.56786 10.2395 4.34619 10.0178C4.12452 9.79614 4 9.49549 4 9.18201C4 8.86852 4.12452 8.56787 4.34619 8.3462C4.56786 8.12454 4.86852 8.00001 5.18201 8.00001H9.46301C9.7225 7.99919 9.97504 8.08372 10.1818 8.24057C10.3885 8.39742 10.5378 8.61788 10.6069 8.86801L15.4399 26.323H28.6179L33.001 16.275H18.401C18.2428 16.2796 18.0854 16.2524 17.9379 16.1951C17.7904 16.1377 17.6559 16.0513 17.5424 15.9411C17.4288 15.8308 17.3386 15.6989 17.277 15.5532C17.2154 15.4074 17.1836 15.2508 17.1836 15.0925C17.1836 14.9343 17.2154 14.7776 17.277 14.6319C17.3386 14.4861 17.4288 14.3542 17.5424 14.2439C17.6559 14.1337 17.7904 14.0473 17.9379 13.9899C18.0854 13.9326 18.2428 13.9054 18.401 13.91H34.814C35.0097 13.91 35.2022 13.9587 35.3744 14.0517C35.5465 14.1448 35.6928 14.2793 35.7999 14.443C35.9078 14.6073 35.9734 14.7957 35.9908 14.9914C36.0083 15.1872 35.9771 15.3842 35.9 15.565L30.495 27.977C30.4026 28.1876 30.251 28.3668 30.0585 28.4927C29.866 28.6186 29.641 28.6858 29.411 28.686H14.553Z"/>
                </svg>
            </button>
            <div class="cart-block" v-if="isVisibleCart">
                <p
                    v-if="!cartitems[1].length"
                >
                    Cart is empty.
                </p>
                <p
                    v-if="cartitems[1].length"
                    class="cart-total"
                >
                    Total: $ {{ calculateCart() }}.
                </p>
                <div
                    class="cart-item"
                    v-for="item of cartitems[1]"
                    :key="item.id_product"
                >
                    <div class="product-bio">
                        <img :src="item.img" alt="Some image" class="product-bio-img">
                        <div class="product-desc">
                            <div class="product-title">{{item.product_name}}</div>
                            <div
                                type="number"
                                class="product-quantity"
                                @input="$parent.$emit('addproduct',item)"
                            >Quantity: {{ item.quantity }}
                            </div>
                            <div class="product-single-price">$ {{item.price}} each</div>
                        </div>
                        <div class="right-block">
                            $ {{item.quantity * item.price}}
                            <button
                                class="del-btn"
                                @click="deleteItem(item.id_product)"
                            >
                                &times;
                            </button>
                        </div>
                    </div>
                </div>
                <div class="btn-continue">
                    <a
                        href="cart.html"
                        class="shopping-cart-btn-modal shopping-cart-btn cart-content-btn cart-content-btn-modal"
                    >
                        buy
                    </a>
                </div>
            </div>
        </div>
    `
})
